**Вы используете бесплатную версию GraberPro с узким функционалом! Приобрести полную можно тут** - https://t.me/delovarshop

# Список отличий от бесплатной версии:
1) Добавил включение и отключение "Безопасного режима". Этот режим не даёт аккаунту получить ограничение по действиям, когда копируется большое количество сообщений
2) Добавил копирование с групп, в которых невозможно копирование или пересылка, доступно командой /last_save
3) Добавил текстовый файл logi.txt где будут храниться все логи, плюс в настройках можно вызвать логи прямо в телеграм, они будут сами обновляться каждые 30 секунд, если увидят новую информацию в логе кода
4) Добавил blacklist слов, а также управление им. Если в посте есть это слово, то пост не будет опубликован
5) Добавил Удаляемые слова, а также управление ими. Если в посте находится слово, которое вы добавили, то весь текст после этого слова (включая слово) будет удалён. Я использую когда в каком то из каналов постоянно указывает в конце поста ссылки на другие каналы (типа "Наши каналы:".. ). Вношу слово "Наши" и всё, текста нет
6) Добавил обработку ошибок в логах и подробное логирование
7) Добавил рерайт текста с помощью Chat GPT не только в одиночные сообщения, но и в сообщения, где есть группы медиа
8) Добавил возможность включать и отключать замену ссылок
9) Добавил возможность командам /last и /last_save указывать не только отправителя, но и получателя. ID отправителя может быть любое (команды не поддаются команде соответствия из инлайн меню), также эти команды теперь не обязательно вводить а можно выбрать группу и количество по кнопкам
10) Переделал визуальную часть в более удобную и интуитивно понятную
11) Исправил баг с тем, когда посты иногда пропускает, если добавлено несколько получателей и отправителей
12) Добавлять получателей и отправителей теперь можно просто переслав сообщение
13) Добавил настраиваемую подпись в конце текста для каждого добавленного получателя
14) Оптимизировал отправку большого количества сообщений
15) Добавил отложенный постинг
16) Добавил генерацию картинки через нейросеть DALL-E 3
17) Исправил баг, когда приходили не все медиафайлы с поста оригинала
В подарок настроил свой прокси, теперь для рерайта текста вам нужен только ключ для Chat GPT

Для нормальной работоспособности используйте версию Python 3.10 - 3.11

# Установка: 
sudo apt update
sudo apt -y upgrade
sudo apt -y install python3-pip
sudo apt -y install build-essential libssl-dev libffi-dev python3-dev
sudo apt install -y python3-venv 

# Библиотека aiogram: 
**(Если в будущем предложит обновить библиотеку aiogram, то не нужно. Всё работает только на версии 2.25.1)**

pip install aiogram==2.25.1

# Библиотека telethon:
**В данный момент всё стабильно работает на последней версии библиотеки telethon (1.33)**

pip install telethon

# Библиотека httpx: 
**(proxy для работы Chat GPT)**

pip install httpx

# Как запустить

1. Создать телеграм-бота. Для этого нужно написать боту [BotFather](https://telegram.me/botfather) и следовать инструкциям. После этого сохраните токен бота.
2. Получить api_id, api_hash. Сделать это можно на сайте [my.telegram.org](https://my.telegram.org/auth). Инструкция: https://www.youtube.com/watch?v=JBDnmEhvgac
3. Задать переменные api_id, api_hash, bot_token и my_id в файле config.py. Также заполните id технического канала (Смотреть 6 пункт)

my_id брать в [Get My ID](https://t.me/getmyid_bot) отсюда (отправить в бот любое сообщение, он выдаст ваш id):


# Запустить бота командой:

python main.py

**При первом запуске нужно ввести НОМЕР ТЕЛЕФОНА (НЕ ТОКЕН) и код, который придёт в telegram** 

# Пример использования:
1. Переходим в telegram бот, который создали в начале. Вводим команду "/start", нажимаем "Добавить канал" и вводим id канала, с которого нужно брать контент. 
id нужного канала можно узнать переслав любое сообщение с канала в бот (пример id для каналов: -1001009232144) [Get My ID](https://t.me/getmyid_bot)
Можно вводить и username через "@", но через id стабильнее работает. **Если через id не получается вводим @username**

2. Добавляем канал, на который должны будут приходить сообщения. Для этого жмём "Добавить канал-получатель". Бот, в котором мы всё это вводим, обязательно должен быть администратором этого канала.
3. **Обязательно** указываем соответсвие между каналами (это пригодится когда добавите несколько каналов-источников и несколько каналов-получателей, при этом хотите чтобы публикации из определённых каналов приходили на конкретные каналы) написав id канала-источника и id канала-получателя через пробел командой /set_channel_mapping (Пример: /set_channel_mapping -100123132890 -1000932314321).
4. После этого перезагружаем код либо вручную закрыв и открыв компилятор кода (стабильнее всего), в котором работаем, либо по кнопке "Перезагрузить бота" (не стабильно). **Теперь все новые сообщения будут приходить на ваш канал.**
5. Также вам доступна команда

/last_messages ко-во сообщений или all, если все
    
Она отправляет последние сообщения на ваш канал. Если добавили несколько каналов-источников, а последние сообщения нужны только с одного канала, то напишите

/last_messages id канала источника ко-во сообщений

6. Режим модерации. При активации режима модерации все сообщения будут приходить сначала на ваш технический канал, в котором вы можете их редактировать, удалять и публиковать:
Для его работы создаём новый пустой канал и вводим id этого канала в technical_channel_id в файле config.py. (получить id можно по аналогии как с остальными каналами). Не забываем назначить бота администратором технического канала.
Если вы отредактировали сообщение, то нажимайте на "Отредактировано" чтобы оно обновилось в хранилище. Возможный баг: когда в техническом канале скапливается большое количество сообщений, то при нажатии на "Отправить" может зависать. Чтобы всё заработало нажимаем на "Отредактировано", а потом "Отправить".

**Также есть возможность заменять все ссылки и упоминания, которые публикуются на каналах на ваши**. В файле config.py замените на нужные вам

# Рерайт текста с Chat GPT
В режиме модерации есть кнопка "Рерайт текста". Для её работы заполняем proxy_url и openai_api_key в файле config.py. proxy_url должны быть формата HTTP или HTTPS. Если у вас прокси с логином и паролем, то в настройках прокси ставьте авторизацию по вашему ip. 
Даже если прокси HTTPS, то тут всё равно должно быть http:

openai_api_key берётся на сайте openai https://platform.openai.com/api-keys при наличии бюджета в https://platform.openai.com/usage . При отсутствии прокси и openai_api_key, то оставьте эти данные пустыми, либо за покупкой можно обратиться ко мне.

# Список доступных команд:
* /start - Начало работы с ботом
* /help - Получить список доступных команд
* /add_channel - Добавить канал для работы
* /remove_channel - Удалить канал из списка
* /list_channels - Показать список добавленных каналов
* /add_destination_channel - Добавить канал-получатель
* /remove_destination_channel - Удалить канал-получатель из списка
* /list_destination_channels - Показать список каналов-получателей
* /set_channel_mapping - Установить соответствие между каналами
* /last_messages (ко-во сообщений или all, если все) - Отправить последние сообщения с каналов
